(()=>{"use strict";class e{constructor(e){this.node=this.createNode(e)}getNode(){return this.node}createNode(e){return this.node=document.createElement(e.tag),this.setClassNames(e.css),this.setTextContent(e.text),this.setId(e.id),e.callback&&this.setCallback(e.callback),e.href&&this.setHref(e.href),e.type&&this.setType(e.type),this.node}setType(e){this.node.type=e}setHref(e){this.node.href=e}setClassNames(e){e&&(this.node.className="",this.node.classList.add(...e))}addClassName(e){e&&this.node.classList.add(e)}removeCLassName(e){e&&this.node.classList.remove(e)}setTextContent(e){e&&(this.node.textContent=e)}setCallback(e,t="click"){this.node.addEventListener(t,e)}setId(e){e&&(this.node.id=e)}setAttribute(e,t){this.node.setAttribute(e,t)}addInnerNode(...t){t.forEach((t=>{t instanceof e?this.node.append(t.getNode()):this.node.append(t)}))}prependInnerNode(...t){t.forEach((t=>{t instanceof e?this.node.prepend(t.getNode()):this.node.prepend(t)}))}removeAllChildren(){for(;this.node.firstChild;)this.node.removeChild(this.node.firstChild)}removeNode(){this.node.remove()}}class t{constructor(t){this.viewNode=new e(t)}getElement(){return this.viewNode.getNode()}addViewInside(...e){e.forEach((e=>this.viewNode.addInnerNode(e.getElement())))}blockView(e){e?this.viewNode.addClassName("blocked"):this.viewNode.removeCLassName("blocked")}}class s extends t{isMarked=!1;isFlagged=!1;constructor(e,t){super({tag:"div",css:["cell"],callback:()=>{this.setMark(),t()}}),this.viewNode.setCallback((e=>this.setFlag(e)),"contextmenu"),this.needPaint=e}setMark(){if(this.isMarked)return this.viewNode.removeCLassName("cell_marked"),void(this.isMarked=!1);this.viewNode.addClassName("cell_marked"),this.isMarked=!0,this.isFlagged=!0,this.setFlag()}setFlag(){if(this.isFlagged)return this.viewNode.removeCLassName("cell_flagged"),void(this.isFlagged=!1);this.viewNode.addClassName("cell_flagged"),this.isMarked=!0,this.isFlagged=!0,this.setMark()}isMarkedCorrectly(){return this.isMarked&&this.needPaint||!this.isMarked&&!this.needPaint}resetCell(){this.isMarked=!1,this.isFlagged=!1,this.viewNode.setClassNames(["cell"])}showSolution(){this.needPaint||!this.isMarked?this.needPaint&&(this.viewNode.removeCLassName("cell_flagged"),this.viewNode.addClassName("cell_marked")):this.viewNode.removeCLassName("cell_marked")}getStatus(){return this.isMarked?"marked":!!this.isFlagged&&"flagged"}setStatus(e){"marked"!==e?"flagged"===e&&this.setFlag():this.setMark()}}class i{static observerInstance=new i;listeners=new Map;static getInstance(){return this.observerInstance}subscribe(e,t){const s=this.listeners.get(e)||new Set;s.add(t),this.listeners.set(e,s)}unsubscribe(e,t){const s=this.listeners.get(e);s&&s.delete(t)}dispatch(e,t){const s=this.listeners.get(e);s&&s.size&&s.forEach((e=>e(t)))}}const a="start-timer",o="stop-game",n="victory",r="block-field";class d extends t{playArea=[];scheme;isPlaying=!1;observer=i.getInstance();constructor(){super({tag:"div",css:["field","field_10","puzzle__item"]}),this.configureView(),this.observer.subscribe(r,(e=>{e?this.viewNode.addClassName("solution"):this.viewNode.removeCLassName("solution")}))}configureView(){}generateField(e,t){this.isPlaying=!1,this.viewNode.removeAllChildren(),this.viewNode.setClassNames(["field",`field_${e.length}`]),this.playArea=e.map((e=>e.map((e=>new s(e,this.isVictory.bind(this)))))),this.playArea.forEach((e=>this.addViewInside(...e))),this.playArea=this.playArea.flat(5),t&&this.loadSavedField(t)}isVictory(){this.isPlaying||(this.isPlaying=!0,this.observer.dispatch(a));for(let e=0;e<this.playArea.length;e+=1)if(!this.playArea[e].isMarkedCorrectly())return!1;return this.viewNode.addClassName("solution"),this.observer.dispatch(n),!0}resetGame(){this.viewNode.removeCLassName("solution"),this.isPlaying=!1,this.playArea.forEach((e=>e.resetCell()))}showSolution(){this.viewNode.addClassName("solution"),this.playArea.forEach((e=>e.showSolution()))}saveGame(){return this.playArea.map((e=>e.getStatus()))}loadSavedField(e){this.playArea.forEach(((t,s)=>t.setStatus(e[s])))}}class l extends t{constructor(e=""){super({tag:"div",css:["bar-cell"],text:e})}}class c extends t{constructor(){super({tag:"div",css:["left-bar","bar"]})}configureView(){}generateGame(t){this.viewNode.removeAllChildren();const{length:s}=t;this.viewNode.setClassNames(["left-bar",`left-bar_${s}`]);const i=[];for(let e=0;e<s;e+=1){let a=0;const o=[];for(let i=0;i<s;i+=1)t[e][i]?a+=1:(a&&o.push(a),a=0),i===s-1&&a&&o.push(a);i.push(o)}const a=Math.max(...i.map((e=>e.length)));i.map((e=>[...new Array(a-e.length).fill(""),...e])).forEach((t=>{const s=new e({tag:"div",css:["left-bar__row"]});s.addInnerNode(...t.map((e=>new l(e).getElement()))),this.viewNode.addInnerNode(s)}))}}const h="upper-bar";class g extends t{constructor(){super({tag:"div",css:[h,"bar"]}),this.configureView()}configureView(){}generateGame(t){this.viewNode.removeAllChildren();const{length:s}=t;this.viewNode.setClassNames([h,`upper-bar_${s}`]);const i=[];for(let e=0;e<s;e+=1){let a=0;const o=[];for(let i=0;i<s;i+=1)t[i][e]?a+=1:(a&&o.push(a),a=0),i===s-1&&a&&o.push(a);i.push(o)}const a=Math.max(...i.map((e=>e.length)));i.map((e=>[...new Array(a-e.length).fill(""),...e])).forEach((t=>{const s=new e({tag:"div",css:["upper-bar__column"]});s.addInnerNode(...t.map((e=>new l(e).getElement()))),this.viewNode.addInnerNode(s)}))}}const m="puzzle";class u extends t{constructor(){super({tag:"div",css:[m]}),this.viewNode.setCallback((e=>e.preventDefault()),"contextmenu"),this.field=new d,this.leftList=new c,this.upperList=new g,this.gameTitle=new e({tag:"p",text:"",css:["puzzle__title"]}),this.viewNode.addInnerNode(this.gameTitle),this.addViewInside(this.field,this.leftList,this.upperList)}generateGame(e,t,s){this.viewNode.setClassNames([m,`puzzle_${t}`,`puzzle_${e.length}`]),this.gameTitle.setTextContent(t),this.field.generateField(e,s),this.leftList.generateGame(e),this.upperList.generateGame(e)}resetGame(){this.field.resetGame()}showSolution(){this.field.showSolution()}saveGame(){return this.field.saveGame()}}const w={five:{chicken:[[!1,!0,!1,!1,!1],[!0,!0,!1,!0,!0],[!1,!0,!0,!0,!1],[!1,!0,!0,!0,!1],[!1,!1,!0,!1,!1]],dog:[[!1,!1,!1,!0,!0],[!0,!1,!1,!0,!0],[!0,!0,!0,!0,!1],[!1,!0,!1,!0,!1],[!1,!0,!1,!0,!1]],fountain:[[!1,!0,!1,!0,!1],[!0,!1,!0,!1,!0],[!1,!1,!0,!1,!1],[!0,!0,!0,!0,!0],[!1,!0,!0,!0,!1]],clock:[[!1,!0,!0,!0,!1],[!0,!1,!0,!1,!0],[!0,!1,!0,!0,!0],[!0,!1,!1,!1,!0],[!1,!0,!0,!0,!1]],heart:[[!1,!0,!1,!0,!1],[!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0],[!1,!0,!0,!0,!1],[!1,!1,!0,!1,!1]]},ten:{helicopter:[[!0,!0,!0,!1,!0,!0,!0,!1,!1,!1],[!1,!1,!1,!0,!1,!1,!1,!1,!1,!1],[!1,!0,!0,!0,!0,!0,!1,!1,!1,!1],[!0,!0,!1,!0,!0,!0,!0,!1,!1,!0],[!0,!1,!1,!0,!0,!0,!0,!0,!0,!0],[!0,!1,!1,!0,!0,!0,!0,!0,!1,!0],[!0,!0,!0,!0,!0,!0,!0,!1,!1,!1],[!1,!0,!0,!0,!0,!0,!1,!1,!1,!1],[!0,!1,!0,!1,!0,!1,!1,!1,!1,!1],[!0,!0,!0,!0,!0,!0,!0,!1,!1,!1]],fish:[[!1,!1,!1,!1,!1,!0,!0,!0,!0,!1],[!1,!1,!1,!1,!0,!0,!0,!1,!1,!1],[!1,!1,!0,!0,!0,!0,!0,!1,!1,!1],[!1,!0,!0,!0,!0,!0,!0,!0,!1,!0],[!1,!0,!1,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!1,!0,!1,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!1,!0,!0,!0,!0,!0],[!1,!0,!0,!1,!0,!0,!0,!0,!1,!0],[!1,!1,!0,!0,!0,!0,!1,!1,!1,!0],[!1,!1,!1,!1,!0,!0,!0,!0,!1,!1]],kettle:[[!1,!1,!1,!1,!1,!0,!1,!1,!1,!1],[!1,!1,!1,!0,!0,!0,!0,!0,!1,!1],[!1,!1,!1,!0,!0,!0,!0,!0,!1,!1],[!0,!0,!1,!0,!1,!0,!0,!0,!0,!0],[!1,!0,!1,!0,!0,!0,!0,!0,!1,!0],[!1,!0,!1,!0,!1,!0,!0,!0,!1,!0],[!1,!0,!0,!0,!1,!0,!0,!0,!1,!0],[!1,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!1,!1,!1,!0,!0,!0,!0,!0,!1,!1],[!1,!1,!1,!0,!0,!0,!0,!0,!1,!1]],cocktail:[[!1,!1,!1,!1,!1,!1,!1,!1,!0,!1],[!1,!1,!1,!1,!1,!1,!1,!0,!1,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!1,!1,!1,!1,!0,!1,!0,!0],[!1,!0,!0,!1,!1,!0,!1,!0,!0,!1],[!1,!1,!0,!0,!0,!0,!0,!0,!1,!1],[!1,!1,!1,!1,!0,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!1,!1,!1,!1],[!1,!1,!1,!0,!0,!0,!0,!1,!1,!1]],worm:[[!1,!0,!0,!0,!1,!1,!1,!1,!1,!1],[!0,!1,!0,!1,!0,!1,!1,!1,!1,!1],[!0,!0,!0,!0,!0,!1,!1,!1,!1,!1],[!0,!0,!1,!0,!1,!1,!1,!1,!1,!1],[!1,!0,!0,!1,!1,!1,!1,!1,!1,!1],[!1,!0,!0,!1,!1,!1,!1,!1,!1,!1],[!1,!0,!0,!1,!1,!1,!0,!0,!0,!1],[!1,!0,!0,!0,!1,!0,!0,!0,!0,!0],[!1,!0,!0,!0,!0,!0,!0,!1,!0,!0],[!1,!1,!0,!0,!0,!0,!1,!1,!1,!1]]},fifteen:{bee:[[!0,!0,!0,!1,!0,!0,!1,!1,!0,!0,!0,!0,!1,!1,!1],[!1,!1,!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!0,!0],[!1,!1,!0,!1,!1,!0,!1,!0,!1,!1,!0,!0,!1,!1,!0],[!1,!0,!0,!0,!0,!0,!1,!0,!1,!0,!0,!1,!1,!1,!0],[!0,!1,!1,!1,!0,!0,!0,!0,!1,!0,!1,!1,!1,!1,!0],[!0,!0,!1,!0,!1,!1,!0,!0,!1,!0,!1,!1,!1,!0,!0],[!0,!1,!1,!1,!1,!0,!0,!0,!0,!0,!1,!0,!0,!0,!1],[!0,!0,!1,!1,!0,!0,!1,!1,!0,!0,!0,!0,!1,!1,!1],[!1,!0,!0,!0,!0,!0,!0,!1,!1,!0,!0,!0,!0,!1,!1],[!1,!1,!1,!1,!1,!1,!0,!0,!0,!0,!1,!1,!0,!0,!0],[!0,!1,!1,!0,!0,!0,!0,!0,!1,!1,!1,!0,!0,!0,!0],[!0,!0,!1,!0,!1,!0,!1,!0,!1,!0,!0,!0,!0,!1,!0],[!0,!0,!1,!0,!1,!0,!1,!0,!0,!0,!0,!0,!1,!1,!0],[!0,!0,!0,!1,!1,!1,!1,!1,!0,!0,!0,!1,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]],cat:[[!1,!0,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!0,!0,!0],[!1,!0,!0,!1,!1,!1,!1,!1,!0,!0,!1,!1,!1,!1,!0],[!1,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,!1,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,!0,!1],[!1,!0,!1,!0,!0,!1,!0,!0,!1,!0,!1,!1,!1,!0,!1],[!0,!0,!0,!0,!1,!0,!1,!0,!0,!0,!0,!1,!0,!0,!1],[!1,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,!0,!1,!1],[!1,!1,!0,!0,!0,!0,!0,!0,!0,!1,!1,!1,!0,!0,!1],[!1,!1,!1,!1,!0,!0,!0,!0,!1,!1,!1,!1,!1,!0,!1],[!1,!1,!1,!0,!0,!0,!0,!0,!0,!1,!1,!1,!1,!0,!1],[!1,!1,!1,!0,!0,!0,!0,!0,!0,!1,!1,!1,!0,!0,!1],[!1,!1,!0,!0,!0,!0,!0,!0,!0,!0,!1,!0,!0,!1,!1],[!1,!1,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,!1],[!1,!1,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,!1,!1],[!1,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,!1]],camera:[[!1,!1,!1,!1,!0,!0,!0,!0,!0,!0,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!0,!0,!0,!0,!0,!1,!1,!1,!1],[!1,!0,!0,!1,!1,!1,!0,!0,!0,!1,!1,!0,!0,!0,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!1,!1,!1,!1,!0,!0,!0,!0,!0,!1,!1,!1,!1,!0],[!0,!1,!1,!1,!0,!0,!1,!1,!1,!0,!0,!1,!1,!1,!0],[!0,!0,!0,!0,!0,!1,!0,!0,!0,!1,!0,!0,!0,!0,!0],[!0,!0,!1,!0,!1,!0,!0,!1,!0,!0,!1,!0,!0,!0,!0],[!0,!0,!1,!0,!1,!0,!1,!0,!0,!0,!1,!0,!0,!0,!0],[!0,!0,!1,!0,!1,!0,!1,!0,!0,!0,!1,!0,!0,!0,!0],[!0,!0,!1,!0,!0,!1,!0,!0,!0,!1,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!1,!1,!1,!0,!0,!0,!0,!0,!0],[!1,!1,!1,!1,!1,!0,!0,!0,!0,!0,!1,!1,!1,!1,!1]],bike:[[!1,!1,!1,!1,!1,!1,!1,!0,!0,!0,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!0,!1,!0,!0,!0,!0,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!0,!0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!0,!1],[!1,!1,!1,!0,!0,!0,!0,!1,!1,!1,!0,!1,!1,!1,!1],[!1,!1,!1,!0,!0,!0,!1,!1,!1,!1,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,!1],[!1,!0,!0,!0,!0,!0,!1,!1,!1,!0,!0,!0,!0,!0,!1],[!0,!0,!1,!1,!0,!0,!0,!1,!0,!0,!1,!0,!1,!0,!0],[!0,!1,!1,!0,!0,!1,!0,!1,!0,!1,!1,!0,!1,!1,!0],[!0,!1,!0,!0,!1,!1,!0,!0,!0,!1,!1,!0,!0,!1,!0],[!0,!1,!0,!0,!1,!1,!0,!0,!0,!1,!1,!0,!1,!1,!0],[!0,!0,!1,!1,!1,!0,!0,!1,!0,!0,!1,!1,!1,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]],scales:[[!1,!1,!1,!1,!1,!1,!0,!0,!0,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!0,!1,!0,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!0,!0,!0,!1,!1,!1,!1,!1,!1],[!0,!0,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!0,!0],[!1,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1],[!1,!1,!0,!1,!1,!1,!1,!0,!1,!1,!1,!1,!0,!1,!1],[!1,!1,!0,!1,!1,!1,!1,!0,!1,!1,!1,!1,!0,!1,!1],[!1,!0,!0,!0,!1,!1,!1,!0,!1,!1,!1,!0,!0,!0,!1],[!1,!0,!1,!0,!1,!1,!1,!0,!1,!1,!1,!0,!1,!0,!1],[!1,!0,!1,!0,!1,!1,!1,!0,!1,!1,!1,!0,!1,!0,!1],[!0,!0,!0,!0,!0,!1,!1,!0,!1,!1,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!1,!0,!0,!0,!1,!0,!1,!1,!1,!0],[!1,!0,!0,!0,!1,!1,!0,!1,!0,!1,!1,!0,!0,!0,!1],[!1,!1,!1,!1,!1,!0,!0,!0,!0,!0,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!0,!0,!0,!0,!0,!1,!1,!1,!1]]}};class N extends t{constructor(e,t){super({tag:"div",css:["new-game"]}),this.configureView(e,t)}configureView(t,s){const i=new e({tag:"h2",css:["new-game__title"],text:"New Game"}),a=Object.entries(t),o=a.map((([e,t])=>this.generateCategory(t,s))),n=new e({tag:"button",css:["new-game__random","new-game__button"],text:"random game",callback:()=>{const e=a[Math.floor(Math.random()*a.length)][1],[t,i]=Object.entries(e)[Math.floor(5*Math.random())];s(i,t)}});this.viewNode.addInnerNode(i,...o,n)}generateCategory(t,s){const i=Object.entries(t),a=i[0][1][0].length,o=new e({tag:"div",css:["new-game__container"]}),n=new e({tag:"h3",css:["new-game__subtitle"],text:`${a}x${a}`}),r=i.map((([t,i])=>new e({tag:"button",css:["new-game__button"],text:`${t}`,callback:()=>s(i,t)})));return o.addInnerNode(n,...r),o}}class p extends t{#e=0;stopwatch;#t=i.getInstance();constructor(){super({tag:"p",css:["stopwatch"],text:"00:00"}),this.#t.subscribe(a,(()=>this.startTimer())),this.#t.subscribe(o,(()=>this.stopTimer()))}startTimer(){this.stopwatch=setTimeout((()=>{this.#e+=1,this.updateText(),this.startTimer()}),1e3)}stopTimer(){clearTimeout(this.stopwatch)}updateText(e=this.#e){this.viewNode.setTextContent(`${new Date(1e3*e).toISOString().slice(14,19)}`||"00:00")}set setSeconds(e){this.#e=e,this.updateText()}get getSeconds(){return this.#e}}class v extends t{constructor(e,t,s){super({tag:"div",css:["greeting"]}),this.configureView(e,t,s)}configureView(t,s,i){const a=new e({tag:"button",css:["close","greeting__close"],callback:()=>this.viewNode.removeNode()}),o=new e({tag:"p",css:["greeting__text"],text:`Great! You have solved the ${s}x${s} ${t} nonogram in ${i} seconds!`});this.viewNode.addInnerNode(a,o),document.body.append(this.viewNode.getNode()),this.saveResult(t,`${s}x${s}`,i)}saveResult(e,t,s){const i=JSON.parse(localStorage.getItem("nonogram-result"))||[];i.push({gameName:e,fieldSize:t,seconds:s}),localStorage.setItem("nonogram-result",JSON.stringify(i.sort(((e,t)=>e.seconds-t.seconds)).slice(0,5)))}}class b extends t{resultNode=null;darkMode=!1;#t=i.getInstance();constructor(){super({tag:"div",css:["settings"]}),window.addEventListener("load",(()=>{this.darkMode=JSON.parse(localStorage.getItem("darkMode"))||!1,this.switchDarkMode(),this.configureView()})),window.addEventListener("beforeunload",(()=>{localStorage.setItem("darkMode",JSON.stringify(this.darkMode))}))}configureView(){const t=new e({tag:"label",css:["result__label"]}),s=new e({tag:"input",css:["result__input"],type:"checkbox",callback:()=>this.handleDarkMode(s)});t.addInnerNode(s),s.getNode().checked=this.darkMode;const i=new e({tag:"button",css:["result__button"],text:"score",callback:()=>{this.resultNode&&this.resultNode.removeNode(),this.showBestResult()}});this.viewNode.addInnerNode(t,i)}showBestResult(){const t=new e({tag:"div",css:["result"]});this.resultNode=t;const s=new e({tag:"button",css:["close"],callback:()=>{this.#t.dispatch(r),t.removeNode()}}),i=JSON.parse(localStorage.getItem("nonogram-result"))||[],a=this.generateResultList(i);t.addInnerNode(s,a),document.body.append(t.getNode()),this.#t.dispatch(r,!0)}generateResultList(t){if(!t.length)return new e({tag:"p",text:"List is empty"});const s=new e({tag:"ul",css:["result__list"]});return s.addInnerNode(this.generateHead("â„–","Name","Mode","Time"),...t.map(((e,t)=>this.generateResultRow(t+1,...Object.values(e))))),s}generateResultRow(...t){const s=t;s[s.length-1]=`${new Date(1e3*s[s.length-1]).toISOString().slice(14,19)}`;const i=new e({tag:"li",css:["result-item"]}),a=t.map((t=>new e({tag:"p",css:["result-item__text"],text:t})));return i.addInnerNode(...a),i}generateHead(...t){const s=new e({tag:"li",css:["result-item"]}),i=t.map((t=>new e({tag:"p",css:["result-item__text"],text:t})));return s.addInnerNode(...i),s}handleDarkMode(e){const t=e;this.darkMode=!this.darkMode,t.getNode().checked=this.darkMode,this.switchDarkMode()}switchDarkMode(){this.darkMode?document.body.classList.add("dark"):document.body.classList.remove("dark")}}class f extends t{gameName;fieldSize=0;#t=i.getInstance();constructor(){super({tag:"div",css:["main"]}),this.newGame=new N(w,this.generateGame.bind(this)),this.puzzle=new u(this.showVictory.bind(this)),this.timer=new p,this.controls=this.createControls(),this.settings=new b,this.configureView(),this.#t.subscribe(n,(()=>this.showVictory()))}configureView(){this.addViewInside(this.settings),this.generateGame(w.five.chicken,"chicken")}generateGame(e,t,s=null){this.fieldSize=e.length,this.gameName=t,this.puzzle.generateGame(e,t,s),this.newGame.viewNode.removeNode(),this.viewNode.addInnerNode(this.controls),this.addViewInside(this.puzzle,this.timer)}pickNewGame(){this.puzzle.getElement().remove(),this.timer.getElement().remove(),this.controls.removeNode(),this.addViewInside(this.newGame)}saveGame(){const e={field:this.puzzle.saveGame(),gameName:this.gameName,time:this.timer.getSeconds};localStorage.setItem("saved-game",JSON.stringify(e))}loadGame(){const e=JSON.parse(localStorage.getItem("saved-game"))||null,t=Object.values(w).find((t=>t[e.gameName]))[e.gameName];this.generateGame(t,e.gameName,e.field),this.timer.stopTimer(),this.timer.setSeconds=e.time}createControls(){let t;const s=new e({tag:"button",text:"load game",css:["controls__button"],callback:()=>{this.loadGame(),t.getNode().disabled=!1}});localStorage.getItem("saved-game")||(s.getNode().disabled=!0);const i=new e({tag:"button",text:"save game",css:["controls__button"],callback:()=>{this.saveGame(),s.getNode().disabled=!1}});t=i;const a=new e({tag:"button",text:"reset",css:["controls__button"],callback:()=>{this.puzzle.resetGame(),this.timer.stopTimer(),this.timer.setSeconds=0,i.getNode().disabled=!1}}),r=new e({tag:"button",text:"new game",css:["controls__button"],callback:()=>{this.pickNewGame(),this.timer.stopTimer(),this.timer.setSeconds=0,i.getNode().disabled=!1}}),d=new e({tag:"button",text:"solution",css:["controls__button"],callback:()=>{i.getNode().disabled=!0,this.puzzle.showSolution(),this.#t.dispatch(o)}});this.#t.subscribe(n,(()=>{i.getNode().disabled=!0}));const l=new e({tag:"div",css:["controls"]});return l.addInnerNode(r,a,i,s,d),l}showVictory(){new v(this.gameName,this.fieldSize,this.timer.getSeconds),this.timer.stopTimer()}}new class{constructor(){document.body.append((new f).getElement())}}})();